(function(r,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(r=typeof globalThis<"u"?globalThis:r||self,l(r.MyReact={}))})(this,function(r){"use strict";const l={id:0,effectId:0,depth:-1,component:null};function y(e,i){let u,t;for(u in i)t=i[u],u.startsWith("on")?e.addEventListener(u.slice("2").toLowerCase(),t):u==="ref"?(typeof t=="object"&&(t.current=e),typeof t=="function"&&t(e)):u==="checked"?e[u]=t:u=="style"&&typeof t=="object"?Object.assign(e.style,t):e.setAttribute(u,t)}function d(e){if(e.type==="text"){let t=document.createTextNode(String(e.value));return e.node=t,t}if(typeof e.type=="function")return g(e);const i=document.createElement(e.type);e.node=i,y(i,e.props);const u=e.children;for(let t in u){let f=d(u[t]);i.appendChild(f)}return i}function g(e){l.id=0,l.effectId=0,l.depth+=1,e.depth=l.depth,l.component=e;const i=e.type(e.props),u=d(i);return e.component=i,e.effects.forEach(t=>t.cleanup=t.callback()),l.depth-=1,u}function a(e){e.effects.forEach(i=>{i.cleanup&&i.cleanup()}),e.component.children.forEach(i=>{typeof i.type=="function"&&a(i)})}function h(e,i){return i.some((u,t)=>!Object.is(e[t],u))}function b(e,i){for(let u in i)if(!Object.is(e[u],i[u]))return!0}function c(e,i){if(e.type===i.type){if(e.type==="text")return e.value!==i.value&&(e.value=i.value,e.node.nodeValue=i.value),e;if(typeof e.type=="function")return b(e.props,i.props)&&(e.props=i.props,o(e)),e;{E(e.node,e.props,i.props);const{children:u}=i,{children:t}=e;if(t.length===u.length){for(let f in t)t[f]=c(t[f],u[f]);return e}else if(t.length>u.length){for(let s in u)t[s]=c(t[s],u[s]);let f=u.length;for(;t[f];)typeof t[f].type=="function"?t[f].node.node.remove():(console.log(t[f]),t[f].node.remove()),t.splice(f,1);return e}else{for(let s in t)t[s]=c(t[s],u[s]);let f=t.length;for(;u[f];){let s=d(u[f]);e.node.appendChild(s),e.children.push(u[f]),f++}return e}}}else{const u=d(i);return typeof e.type=="function"?(a(e),e.shouldUpdate=!1,e.component.node.replaceWith(u),i):(e.node.replaceWith(u),i)}}function o(e){l.id=0,l.effectId=0,l.depth=e.depth,l.component=e;let i=[...e.effects];const u=e.type(e.props);e.component=c(e.component,u),e.effects.forEach((t,f)=>{t.cleanup=i[f].cleanup,(!t.dependencies||h(t.dependencies,i[f].dependencies))&&(t.cleanup&&t.cleanup(),t.cleanup=t.callback())}),e.shouldUpdate=!1,l.depth=-1}function E(e,i,u){for(let t in u)if(u[t]!==i[t]){if(t.startsWith("on")){let f=t.slice("2").toLowerCase();e.removeEventListener(f,i[t]),e.addEventListener(f,u[t])}else t==="ref"?(typeof v=="object"&&(v.current=e),typeof v=="function"&&v(e)):t==="checked"?e[t]=v:t=="style"&&typeof value=="object"?Object.assign(e.style,v):e.setAttribute(t,u[t]);i[t]=u[t]}}function j(e){let i;return{render(u){if(i)i=c(i,u);else{l.depth=-1;const t=d(u);e.appendChild(t),i=u}},unmount(){typeof i.type=="function"?(a(i),i.component.node.remove()):i.node.remove(),i=null}}}function T(e,i,...u){for(let f in u)(typeof u[f]=="string"||typeof u[f]=="number")&&(u[f]={type:"text",value:u[f]});let t={type:e,props:i||{},children:u};return typeof e=="function"&&(t.cache=[],t.effects=[],t.component=null,t.depth=null,t.shouldUpdate=!1),t}let n=[];function U(e){n.includes(e)||(e.shouldUpdate=!0,n.push(e))}let p;function k(){clearTimeout(p),p=setTimeout(()=>{n.sort((e,i)=>e.depth-i.depth),n.forEach(e=>{e.shouldUpdate&&o(e)}),n=[]},0)}function I(e){const{id:i,component:u}=l,{cache:t}=u;l.id+=1,t[i]==null&&(t[i]={value:typeof e=="function"?e():e});function f(s){typeof s=="function"?t[i].value=s(t[i].value):t[i].value=s,u.shouldUpdate=!0,U(u),k()}return[t[i].value,f]}function L(e,i){const{effectId:u,component:t}=l,{effects:f}=t;l.effectId+=1,f[u]={dependencies:i,callback:e}}function O(e,i){const{id:u,component:t}=l,{cache:f}=t;return l.id+=1,i?f[u]==null?(f[u]={dependencies:i},f[u].value=e(),f[u].value):(h(f[u].dependencies,i)&&(f[u].value=e(),f[u].dependencies=i),f[u].value):e()}function R(e){const{id:i,component:u}=l,{cache:t}=u;return l.id+=1,t[i]==null&&(t[i]={current:e}),t[i]}r.createElement=T,r.createRoot=j,r.useEffect=L,r.useMemo=O,r.useRef=R,r.useState=I,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
